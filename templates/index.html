{% extends "base.html" %} {% block content %} {% if matiere_exists %}
<div class="container">
  <aside class="sidebar">
    {% if themes %}
    <ul id="themes-list">
      {% for theme in themes %}
      <li
        data-theme-id="{{ loop.index0 }}"
        class="theme-item"
        style="cursor: pointer"
      >
        {{ theme.nom }}
      </li>
      {% endfor %}
    </ul>
    {% else %}
    <p>Aucun thème pour cette matière.</p>
    {% endif %}
  </aside>

  <section class="content-area">
    {% if no_content %}
    <p>Il n’y a pas de leçons ou d’exercices dans cette matière.</p>
    {% else %} {% for theme in themes %}
    <div
      class="theme-content"
      data-theme-id="{{ loop.index0 }}"
      style="display: none"
    >
      <h2>Leçons</h2>
      {% if theme.lessons %}
      <ul>
        {% for lesson in theme.lessons %}
        <li>
          {% if lesson.fichier %}
          <a
            href="{{ url_for('static', filename='uploads/' + lesson.fichier) }}"
            target="_blank"
          >
            {{ lesson.titre or lesson.fichier }}
          </a>
          {% else %}
          <a
            href="{{ url_for('afficher_lecon', theme_id=theme._id|string, lesson_index=loop.index0) }}"
          >
            {{ lesson.titre }}
          </a>
          {% endif %}
        </li>
        {% endfor %}
      </ul>
      {% else %}
      <p>Aucune leçon pour ce thème.</p>
      {% endif %}

      <h2>Exercices</h2>
      {% if theme.exercises %}
      <ul>
        {% for ex in theme.exercises %}
        <li>
          {% if ex.fichier %}
          <a
            href="{{ url_for('static', filename='uploads/' + ex.fichier) }}"
            target="_blank"
          >
            {{ ex.titre or ex.fichier }}
          </a>
          {% elif ex.contenu %}
          <a
            href="{{ url_for('afficher_exercice', theme_id=theme._id|string, exercise_index=loop.index0) }}"
          >
            {{ ex.titre }}
          </a>
          {% else %} {{ ex.titre }} {% endif %}
        </li>
        {% endfor %}
      </ul>
      {% else %}
      <p>Aucun exercice pour ce thème.</p>
      {% endif %}
    </div>
    {% endfor %} {% endif %}
  </section>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const themeItems = document.querySelectorAll(".theme-item");
    const themeContents = document.querySelectorAll(".theme-content");

    function hideAllContents() {
      themeContents.forEach((c) => (c.style.display = "none"));
    }

    // Afficher le premier thème par défaut
    if (themeContents.length > 0) {
      hideAllContents();
      themeContents[0].style.display = "block";
      themeItems[0].classList.add("active");
    }

    themeItems.forEach((item, idx) => {
      item.addEventListener("click", () => {
        hideAllContents();
        themeContents[idx].style.display = "block";

        // Gérer la classe active sur les thèmes
        themeItems.forEach((t) => t.classList.remove("active"));
        item.classList.add("active");
      });
    });
  });
</script>

<style>
  .theme-item.active {
    font-weight: bold;
    color: #2c3e50;
  }
</style>
{% else %}
<p>Sélectionnez une matière pour voir les thèmes.</p>
{% endif %} {% endblock %}
